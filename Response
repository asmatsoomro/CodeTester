import com.fasterxml.jackson.annotation.JsonProperty

data class PricingResponse(
    @JsonProperty("response") val response: Response,
    @JsonProperty("skuId") val skuId: String,
    @JsonProperty("storeId") val storeId: String,
    @JsonProperty("skuPrice") val skuPrice: SkuPrice,
    @JsonProperty("xgridId") val xgridId: String
) {
    data class Response(
        @JsonProperty("skuId") val skuId: String,
        @JsonProperty("storeId") val storeId: String,
        @JsonProperty("skuPrice") val skuPrice: SkuPrice
    )

    data class SkuPrice(
        @JsonProperty("listPrice") val listPrice: Double,
        @JsonProperty("salePrice") val salePrice: Double,
        @JsonProperty("carepassPrice") val carepassPrice: Double,
        @JsonProperty("unitPrice") val unitPrice: String
    )

    data class SkuRangePrice(
        @JsonProperty("listPriceMin") val listPriceMin: Double,
        @JsonProperty("listPriceMax") val listPriceMax: Double,
        @JsonProperty("salePriceMin") val salePriceMin: Double,
        @JsonProperty("salePriceMax") val salePriceMax: Double,
        @JsonProperty("carePassPriceMin") val carePassPriceMin: Double,
        @JsonProperty("carePassPriceMax") val carePassPriceMax: Double,
        @JsonProperty("unitPriceMin") val unitPriceMin: String,
        @JsonProperty("unitPriceMax") val unitPriceMax: String
    )

    data class Variant(
        @JsonProperty("skuId") val skuId: String,
        @JsonProperty("storeId") val storeId: String,
        @JsonProperty("skuPrice") val skuPrice: SkuPrice
    )
}


import org.springframework.stereotype.Service
import org.springframework.web.client.RestTemplate

@Service
class PricingService(private val restTemplate: RestTemplate) {

    fun getPricingData(skuId: String): PricingResponse {
        // Call the pricing service API to fetch pricing data for the given SKU ID
        val url = "/pricing/services/v1/{skuId}"
        val response = restTemplate.getForObject(url, PricingResponse::class.java, skuId)
        return response?.copy(response = response.response.copy(skuId = skuId))
            ?: throw Exception("Failed to fetch pricing data for SKU: $skuId")
    }
}

